@page "/utilisateur/calendrier"
@inject HttpClient client
@inject IJSRuntime JSRuntime

<form>
	<input type="submit" value="Exporter le calendrier" @onclick=@export>
</form>
<div id="calendrier" class="dhx_cal_container" style='width:100%; height:100vh;'>
        <div class="dhx_cal_navline">
            <div class="dhx_cal_prev_button">&nbsp;</div>
            <div class="dhx_cal_next_button">&nbsp;</div>
            <div class="dhx_cal_today_button"></div>
            <div class="dhx_cal_date"></div>
            <div class="dhx_cal_tab" name="day_tab"></div>
            <div class="dhx_cal_tab" name="week_tab"></div>
            <div class="dhx_cal_tab" name="month_tab"></div>
        </div>
        <div class="dhx_cal_header"></div>
        <div class="dhx_cal_data"></div>
</div>
<p>&copy; <a href="https://dhtmlx.com/">dhtmlx</a></p>

@code {
	List<formation> formations = new List<formation>();
	protected override async void OnInitialized()
	{
		formations = await client.GetFromJsonAsync<IEnumerable<formation>>("Formation") as List<formation>;

		foreach (var f in formations) {
			await JSRuntime.InvokeVoidAsync("display", f);
			await JSRuntime.InvokeVoidAsync("addDXCalendearEvent", f, "blue");
		}
	}

	void SelectMine() {
		
	}
		
	async void export() {
		await JSRuntime.InvokeVoidAsync("exportDXCalendar");
	}
}